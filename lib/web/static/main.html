<div class="container">
  <div ng-if="errorMessage">
    <div class="alert alert-danger col-lg-10 col-lg-offset-1" role="alert">
      <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
      <span class="sr-only">Error:</span>
      {{errorMessage}}
    </div>
  </div><!--/errorMessage-->
  <div>
    <p>Welcome, {{currentUser.id}}! <span ng-if="currentUser.role=='admin'">[{{currentUser.role}}]</span></p>
    <p></p>
    <p>Module List</p>
    <div class="table-responsive col-lg-10 col-lg-offset-1">
    <table class="table" ng-init="getModules(currentUser.id)">
      <tr class="active">
        <th>
          <div class="row">
            <div class="col-lg-1">No.</div>
            <div class="col-lg-3">Name</div>
            <div class="col-lg-4">UUID</div>
            <div class="col-lg-2">Type</div>
            <div class="col-lg-2"></div>
          </div>
        </th>
      </tr>
      <tr ng-repeat="item in modules">
        <td ng-if="editMode!=item.count">
          <div class="row">
            <div class="col-lg-1">{{item.count}}</div>
            <div class="col-lg-3">{{item.name}}</div>
            <div class="col-lg-4">{{item.uuid}}</div>
            <div class="col-lg-2">{{item.type}}</div>
            <div class="col-lg-2">
              <button ng-if="editMode==0" type="button" class="btn btn-default btn-sm" aria-label="Modify" ng-click="setEditMode(item.count)">
                <span class="glyphicon glyphicon-cog" aria-hidden="true"></span></button>
              <button ng-if="editMode!=0" type="button" class="btn btn-default btn-sm" aria-label="Modify" disabled="disabled">
                <span class="glyphicon glyphicon-cog" aria-hidden="true"></span></button>
            </div>
          </div>
        </td>
        <td ng-if="editMode==item.count">
          <div class="row">
            <form ng-submit="updateModule(item._id, item)">
              <div class="col-lg-1">{{item.count}}</div>
              <div class="col-lg-3">
                <input type="text" ng-model="item.name" value="{{item.name}}" class="form-control input-sm"></div>
              <div class="col-lg-4">
                <input type="text" ng-model="item.uuid" value="{{item.uuid}}" class="form-control input-sm"></div>
              <div class="col-lg-2">
                <input type="text" ng-model="item.type" value="{{item.type}}" class="form-control input-sm"></div>
              <div class="col-lg-2">
                <button type="button" class="btn btn-default btn-sm" aria-label="Cancel" ng-click="setEditMode(0)">
                  <span class="glyphicon glyphicon-remove" aria-hidden="true"></span></button>
                <button type="submit" class="btn btn-success btn-sm" aria-label="Save">
                  <span class="glyphicon glyphicon-ok" aria-hidden="true"></span></button>
                <button type="button" class="btn btn-danger btn-sm" aria-label="Delete" ng-click="removeModule(item._id)">
                  <span class="glyphicon glyphicon-trash" aria-hidden="true"></span></button>
              </div>
            </form>
          </div>
        </td>
      </tr>
      <tr>
        <td>
          <div class="row">
            <form ng-submit="createModule(newItem)">
              <div class="col-lg-1">New</div>
              <div class="col-lg-3">
                <input type="text" ng-model="newItem.name" class="form-control input-sm" placeholder="Module name"></div>
              <div class="col-lg-4">
                <input type="text" ng-model="newItem.uuid" class="form-control input-sm" placeholder="UUID or Serial Number"></div>
              <div class="col-lg-2">
                <input type="text" ng-model="newItem.type" class="form-control input-sm" placeholder="Type"></div>
              <div class="col-lg-2">
                <button ng-if="editMode==0" type="submit" class="btn btn-primary btn-sm"><span class="glyphicon glyphicon-plus" aria-hidden="true"></span></button>
                <button ng-if="editMode!=0" type="submit" class="btn btn-primary btn-sm" disabled="disabled"><span class="glyphicon glyphicon-plus" aria-hidden="true"></span></button>
              </div>
            </form>
          </div>
        </td>
      </tr>
    </table>
    </div>
  </div>
</div>
